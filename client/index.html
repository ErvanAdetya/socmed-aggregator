<!DOCTYPE html>
<html>
  <head>
    <title>Socmed Aggregator</title>
  </head>
  <body>
        <div id='searchBarDiv'>
            <input id="searchBar" text="text" name"keyword">
            <button id="searchButton">Search</button>
        </div>
        <div id='postDiv'>
            <table>
                <form action="#">
                    <tr>
                        <th><input id="tweetBar" type="text" name="tweet" value="post"></th>
                        <th><button id="postTweet">post !</button></th>
                    </tr>
                </form>
            </table>
        </div>
        <div id='tweetDiv'>
            <table id="tweet">
                <tr>
                    <th><h4>Id</h4></th>
                    <th><h4>Tweet</h4></th>
                    <th><h4>Date</h4></th>
                </tr>
            </table>
        </div>
        <div id='searchDiv'>
            <table id='searchTable'>
                <tr><th><h4>Search Result</h4></th></tr>
            </table>
        </div>
      <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
      <script>
            $.ajax({
                url: 'http://localhost:3000/twitter',
                method: 'GET',
                success: function(tweets) {
                    tweets = JSON.parse(tweets)
                    tweets.forEach((tweet) => {
                        temp = `
                            <tr>
                                <th><h5>${tweet.id}</h5></th>
                                <th><h5>${tweet.text}</h5></th>
                                <th><h5>${tweet.created_at}</h5></th>
                            </tr>
                            `;
                        $('#tweet').append(temp);
                    })
                }
            });
            $('#postTweet').click(() => {
                $.ajax({
                    url: 'http://localhost:3000/twitter',
                    method: 'POST',
                    data: {tweet : $('#tweetBar').val()},
                    success: function(tweets) {
                        console.log( $('#tweetBar'))
                        console.log(tweets)
                    }
                })
            })
            $('#searchButton').click(() => {
                let tempBody = {
                    keyword: $('#searchBar').val()
                };
                $.ajax({
                    url: 'http://localhost:3000/twitter/search',
                    method: 'POST',
                    data: tempBody,
                    success: function(searchRes) {
                        searchRes = JSON.parse(searchRes)
                        searchRes.statuses.forEach((tweet) => {
                            let template =`
                                    <div>
                                        <div>
                                            <p>${tweet.id}  ${tweet.created_at}</p>
                                        </div>
                                        <div>
                                            <p>${tweet.text}</p>
                                        </div>
                                    </div>
                                `;
                            $('#searchDiv').append(template);
                        })
                  }

              })
          })
      </script>
  </body>
</html>